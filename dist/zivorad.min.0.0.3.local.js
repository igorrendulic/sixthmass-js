var $jscomp={scope:{},checkStringArgs:function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""}};
$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6-impl","es3");
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,a,"startsWith");a+="";for(var e=b.length,f=a.length,g=Math.max(0,Math.min(c|0,b.length)),h=0;h<f&&g<e;)if(b[g++]!=a[h++])return!1;return h>=f}},"es6-impl","es3");var m6_util={},XMLHttpFactories=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];
m6_util.createXMLHTTPObject=function(){for(var a=!1,b=0;b<XMLHttpFactories.length;b++){try{a=XMLHttpFactories[b]()}catch(c){continue}break}return a};m6_util.timestamp=function(){Date.now=Date.now||function(){return+new Date};return Date.now()};m6_util.isBlockedUA=function(a){return/(google web preview|baiduspider|yandexbot|bingbot|googlebot|yahoo! slurp)/i.test(a)?!0:!1};m6_util.isTag=function(a,b){return a&&a.tagName&&a.tagName.toLowerCase()===b.toLowerCase()};
m6_util.formatDate=function(a){function b(a){return 10>a?"0"+a:a}return a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1)+"-"+b(a.getUTCDate())+"T"+b(a.getUTCHours())+":"+b(a.getUTCMinutes())+":"+b(a.getUTCSeconds())};m6_util.each=function(a,b,c){if(null!==a&&void 0!==a)if(Array.prototype&&a.forEach===Array.prototype)a.forEach(b,c);else if(a.length===+a.length)for(var d=0,e=a.length;d<e&&!(d in a&&b.call(c,a[d],d,a)==={});d++);else for(d in a)if(hasOwnProperty.call(a,d)&&b.call(c,a[d],d,a)==={})break};
m6_util.isUndefined=function(a){return void 0===a};m6_util.shouldTrackDOMEvent=function(a){if(!a||this.isTag(a,"html")||a.nodeType!==ELEMENT_NODE)return!1;switch(a.tagName.toLowerCase()){case "html":return!1;case "form":return!0;case "input":return-1===["button","submit"].indexOf(a.getAttribute("type"))?!1:!0;case "select":case "textarea":return!1;default:return!0}};
m6_util.getClassName=function(a){switch(typeof a.className){case "string":return a.className;case "object":return a.className.baseVal||a.getAttribute("class")||"";default:return""}};m6_util.getPropertiesFromElement=function(a){var b={classes:this.getClassName(a).split(" "),tag_name:a.tagName.toLowerCase()},c=[];this.each(a.attributes,function(a){c.push({name:a.name,value:a.value})});b.attributes=c;return b};
m6_util.islocalStorageSupported=function(){var a=!0;try{m6_util.localStorage.set("__m6storagesupport__","sixthmass"),"sixthmass"!==m6_util.localStorage.get("__m6storagesupport__")&&(a=!1),m6_util.localStorage.remove("__m6storagesupport__")}catch(b){a=!1}a||console.error("localStorage unsupported; falling back to cookie store");return a};
m6_util.uuid4=function(){var a=Date.now();window.performance&&"function"===typeof window.performance.now&&(a+=performance.now());return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;a=Math.floor(a/16);return("x"==b?c:c&3|8).toString(16)})};m6_util.timestamp=function(){Date.now=Date.now||function(){return+new Date};return Date.now()};m6_util.timezone=function(){return(new Date).getTimezoneOffset()};
m6_util.isArray=Array.isArray||function(a){return"[object Array]"===toString.call(a)};m6_util.storage={get:function(a,b){return b&&"m6_local"===b?m6_util.localStorage.get(a):m6_util.cookieStorage.get(a)},set:function(a,b,c){c&&"m6_local"===c?m6_util.localStorage.set(a,b):m6_util.cookieStorage.set(a,b,5E3,!0,!0)},remove:function(a,b){b&&"m6_local"===b?m6_util.localStorage.remove(a):m6_util.cookieStorage.remove(a,!0)},parse:function(a,b){return b&&"m6_local"===b?m6_util.localStorage.parse(a):m6_util.cookieStorage.parse(a)}};
m6_util.localStorage={error:function(a){console.error("localStorage error: "+a)},get:function(a){try{return window.localStorage.getItem(a)}catch(b){console.error(b)}return null},parse:function(a){try{return m6_util.JSONDecode(m6_util.localStorage.get(a))||{}}catch(b){}return null},set:function(a,b){try{window.localStorage.setItem(a,b)}catch(c){console.error(c)}},remove:function(a){try{window.localStorage.removeItem(a)}catch(b){console.error(b)}}};
m6_util.cookieStorage={get:function(a){a+="=";for(var b=document.cookie.split(";"),c=0;c<b.length;c++){for(var d=b[c];" "==d.charAt(0);)d=d.substring(1,d.length);if(0===d.indexOf(a)){var e=d.substring(a.length,d.length);if(e&&null!==e&&0<e.length)return decodeURIComponent(d.substring(a.length,d.length))}}return null},parse:function(a){var b;try{b=m6_util.JSONDecode(m6_util.cookie.get(a))||{}}catch(c){}return b},set_seconds:function(a,b,c,d,e){var f="",g="",h="";d&&(f=(f=(f=document.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i))?
f[0]:"")?"; domain=."+f:"");c&&(g=new Date,g.setTime(g.getTime()+1E3*c),g="; expires="+g.toGMTString());e&&(h="; secure");document.cookie=a+"="+encodeURIComponent(b)+g+"; path=/"+f+h},set:function(a,b,c,d,e){var f="",g="",h="";d&&(f=(f=(f=document.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i))?f[0]:"")?"; domain=."+f:"");c&&(g=new Date,g.setTime(g.getTime()+864E5*c),g="; expires="+g.toGMTString());e&&(h="; secure");a=a+"="+encodeURIComponent(b)+g+"; path=/"+f+h;return document.cookie=
a},remove:function(a,b){document.cookie.set(a,"",-1,b)}};m6_util.getQueryParam=function(a,b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c=(new RegExp("[\\?&]"+b+"=([^&#]*)")).exec(a);return null===c||c&&"string"!==typeof c[1]&&c[1].length?null:decodeURIComponent(c[1]).replace(/\+/g," ")};m6_util.includes=function(a,b){return-1!==a.indexOf(b)};
m6_util.referingFrom={domain:function(a){a=a.split("/");return 3<=a.length?a[2]:null},searchEngine:function(a){return 0===a.search("https?://(.*)google.([^/?]*)")?"google":0===a.search("https?://(.*)bing.com")?"bing":0===a.search("https?://(.*)yahoo.com")?"yahoo":0===a.search("https?://(.*)duckduckgo.com")?"duckduckgo":null},searchQuery:function(a){var b=m6_util.referingFrom.searchEngine(a),c="";null!==b&&(a=m6_util.getQueryParam(a,"yahoo"!=b?"q":"p"),a.length&&(c=c+","+a));return c},browser:function(a,
b,c){b=b||"";return c||m6_util.includes(a," OPR/")?m6_util.includes(a,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(a)?"BlackBerry":m6_util.includes(a,"IEMobile")||m6_util.includes(a,"WPDesktop")?"Internet Explorer Mobile":m6_util.includes(a,"Edge")?"Microsoft Edge":m6_util.includes(a,"FBIOS")?"Facebook Mobile":m6_util.includes(a,"Chrome")?"Chrome":m6_util.includes(a,"CriOS")?"Chrome iOS":m6_util.includes(a,"UCWEB")||m6_util.includes(a,"UCBrowser")?"UC Browser":m6_util.includes(a,
"FxiOS")?"Firefox iOS":m6_util.includes(b,"Apple")?m6_util.includes(a,"Mobile")?"Mobile Safari":"Safari":m6_util.includes(a,"Android")?"Android Mobile":m6_util.includes(a,"Konqueror")?"Konqueror":m6_util.includes(a,"Firefox")?"Firefox":m6_util.includes(a,"MSIE")||m6_util.includes(a,"Trident/")?"Internet Explorer":m6_util.includes(a,"Gecko")?"Mozilla":null},browserVersion:function(a,b,c){b={"Internet Explorer Mobile":/rv:(\d+(\.\d+)?)/,"Microsoft Edge":/Edge\/(\d+(\.\d+)?)/,Chrome:/Chrome\/(\d+(\.\d+)?)/,
"Chrome iOS":/CriOS\/(\d+(\.\d+)?)/,"UC Browser":/(UCBrowser|UCWEB)\/(\d+(\.\d+)?)/,Safari:/Version\/(\d+(\.\d+)?)/,"Mobile Safari":/Version\/(\d+(\.\d+)?)/,Opera:/(Opera|OPR)\/(\d+(\.\d+)?)/,Firefox:/Firefox\/(\d+(\.\d+)?)/,"Firefox iOS":/FxiOS\/(\d+(\.\d+)?)/,Konqueror:/Konqueror:(\d+(\.\d+)?)/,BlackBerry:/BlackBerry (\d+(\.\d+)?)/,"Android Mobile":/android\s(\d+(\.\d+)?)/,"Internet Explorer":/(rv:|MSIE )(\d+(\.\d+)?)/,Mozilla:/rv:(\d+(\.\d+)?)/}[m6_util.referingFrom.browser(a,b,c)];return void 0===
b?null:(a=a.match(b))?parseFloat(a[a.length-2]):null},os:function(a){return/Windows/i.test(a)?/Phone/.test(a)||/WPDesktop/.test(a)?"Windows Phone":"Windows":/(iPhone|iPad|iPod)/.test(a)?"iOS":/Android/.test(a)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(a)?"BlackBerry":/Mac/i.test(a)?"Mac OS X":/Linux/.test(a)?"Linux":null},device:function(a){return/Windows Phone/i.test(a)||/WPDesktop/.test(a)?"Windows Phone":/iPad/.test(a)?"iPad":/iPod/.test(a)?"iPod Touch":/iPhone/.test(a)?"iPhone":/(BlackBerry|PlayBook|BB10)/i.test(a)?
"BlackBerry":/Android/.test(a)?"Android":null},language:function(){return navigator.language||navigator.userLanguage}};
m6_util.encodeUTF8=function(a){for(var b=0,c=new Uint8Array(4*a.length),d=0;d!=a.length;d++){var e=a.charCodeAt(d);if(128>e)c[b++]=e;else{if(2048>e)c[b++]=e>>6|192;else{if(55295<e&&56320>e){if(++d==a.length)throw"UTF-8 encode: incomplete surrogate pair";var f=a.charCodeAt(d);if(56320>f||57343<f)throw"UTF-8 encode: second char code 0x"+f.toString(16)+" at index "+d+" in surrogate pair out of range";e=65536+((e&1023)<<10)+(f&1023);c[b++]=e>>18|240;c[b++]=e>>12&63|128}else c[b++]=e>>12|224;c[b++]=e>>
6&63|128}c[b++]=e&63|128}}return c.subarray(0,b)};
m6_util.decodeUTF8=function(a){for(var b="",c=0;c<a.length;){var d=a[c++];if(127<d){if(191<d&&224>d){if(c>=a.length)throw"UTF-8 decode: incomplete 2-byte sequence";d=(d&31)<<6|a[c]&63}else if(223<d&&240>d){if(c+1>=a.length)throw"UTF-8 decode: incomplete 3-byte sequence";d=(d&15)<<12|(a[c]&63)<<6|a[++c]&63}else if(239<d&&248>d){if(c+2>=a.length)throw"UTF-8 decode: incomplete 4-byte sequence";d=(d&7)<<18|(a[c]&63)<<12|(a[++c]&63)<<6|a[++c]&63}else throw"UTF-8 decode: unknown multibyte start 0x"+d.toString(16)+
" at index "+(c-1);++c}if(65535>=d)b+=String.fromCharCode(d);else if(1114111>=d)d-=65536,b+=String.fromCharCode(d>>10|55296),b+=String.fromCharCode(d&1023|56320);else throw"UTF-8 decode: code point 0x"+d.toString(16)+" exceeds UTF-16 reach";}return b};
m6_util.JSONDecode=function(){var a,b,c={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},d,e=function(b){throw{name:"SyntaxError",message:b,at:a,text:d};},f=function(c){c&&c!==b&&e("Expected '"+c+"' instead of '"+b+"'");b=d.charAt(a);a+=1;return b},g=function(){var a;a="";"-"===b&&(a="-",f("-"));for(;"0"<=b&&"9">=b;)a+=b,f();if("."===b)for(a+=".";f()&&"0"<=b&&"9">=b;)a+=b;if("e"===b||"E"===b){a+=b;f();if("-"===b||"+"===b)a+=b,f();for(;"0"<=b&&"9">=b;)a+=b,f()}a=+a;if(isFinite(a))return a;
e("Bad number")},h=function(){var a,d,g="",h;if('"'===b)for(;f();){if('"'===b)return f(),g;if("\\"===b)if(f(),"u"===b){for(d=h=0;4>d;d+=1){a=parseInt(f(),16);if(!isFinite(a))break;h=16*h+a}g+=String.fromCharCode(h)}else if("string"===typeof c[b])g+=c[b];else break;else g+=b}e("Bad string")},l=function(){for(;b&&" ">=b;)f()},m=function(){switch(b){case "t":return f("t"),f("r"),f("u"),f("e"),!0;case "f":return f("f"),f("a"),f("l"),f("s"),f("e"),!1;case "n":return f("n"),f("u"),f("l"),f("l"),null}e('Unexpected "'+
b+'"')},k;k=function(){l();switch(b){case "{":var a;a:{var c={};if("{"===b){f("{");l();if("}"===b){f("}");a=c;break a}for(;b;){a=h();l();f(":");Object.hasOwnProperty.call(c,a)&&e('Duplicate key "'+a+'"');c[a]=k();l();if("}"===b){f("}");a=c;break a}f(",");l()}}e("Bad object");a=void 0}return a;case "[":a:{a=[];if("["===b){f("[");l();if("]"===b){f("]");break a}for(;b;){a.push(k());l();if("]"===b){f("]");break a}f(",");l()}}e("Bad array");a=void 0}return a;case '"':return h();case "-":return g();default:return"0"<=
b&&"9">=b?g():m()}};return function(c){d=c;a=0;b=" ";c=k();l();b&&e("Syntax error");return c}}();
m6_util.JSONEncode=function(){return function(a){var b=function(a){var b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};b.lastIndex=0;return b.test(a)?'"'+a.replace(b,function(a){var b=c[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'},c=function(a,e){var d="",g;g="";var h,l=d,m,k=e[a];k&&"object"===
typeof k&&"function"===typeof k.toJSON&&(k=k.toJSON(a));switch(typeof k){case "string":return b(k);case "number":return isFinite(k)?String(k):"null";case "boolean":case "null":return String(k);case "object":if(!k)return"null";d+="    ";m=[];if("[object Array]"===toString.apply(k)){h=k.length;for(g=0;g<h;g+=1)m[g]=c(g,k)||"null";return h=0===m.length?"[]":d?"[\n"+d+m.join(",\n"+d)+"\n"+l+"]":"["+m.join(",")+"]"}for(g in k)hasOwnProperty.call(k,g)&&(h=c(g,k))&&m.push(b(g)+(d?": ":":")+h);return h=0===
m.length?"{}":d?"{"+m.join(",")+""+l+"}":"{"+m.join(",")+"}"}};return c("",{"":a})}}();var ELEMENT_NODE=1,TEXT_NODE=3,STORAGE_LOCAL="m6_local",STORAGE_COOKIES="m6_cookies",STORAGE_USER_PROFILE="m6_user_profile",STORAGE_SESSION="m6_session",STORAGE_QUEUE="m6_queue",STORAGE_QUEUE_INDEX="m6_queue_index",INACTIVE_SESSION_RESET=30,URL="http://localhost:8079/v1/event",URL_PROFILE="http://localhost:8079/v1/profile",globalDataQueue=[],m6_instance,Config={DEBUG:!0,LIB_VERSION:"0.0.2",events:["click"],attributePrefix:"m6-",trackOnlyM6:!0},PostfixAction="event",SixthMassLib=function(){};
function _m6_init(){var a=window.m6;if(a){var b=new SixthMassLib;b.executeFunctions(a,b);return m6_instance=b}console.error("SixthMass is undefined!")}
SixthMassLib.prototype.init=function(a){this.initParams={token:a};this.Config=Config;null!=this.initParams.trackOnlyM6&&(this.Config.trackOnlyM6=this.initParams.trackOnlyM6);m6_util.islocalStorageSupported()?this.Config.storage=STORAGE_LOCAL:this.Config.storage=STORAGE_COOKIES;this.PostfixAction=PostfixAction;this.initUser();a=this.Config.events;for(var b=0;b<a.length;b++)this.registerEvent(a[b],document,!0)};SixthMassLib.prototype.track=function(a,b){var c=this.createEvent(a,b,this);this.queueEvent(c)};
SixthMassLib.prototype.profile=function(a,b){var c=this.createProfile(a,b,this),d={};d.data=c;this.httpRequest(d,this.getProfileUrl(),1,!1)};SixthMassLib.prototype.purchase=function(a){m6_util.isArray(a)?(a=this.createPurchase(a,this),this.queueEvent(a)):console.error("Required array of purchased items.")};SixthMassLib.prototype.register=function(a,b){var c=this.createRegister(a,b,this);this.queueEvent(c);this.profile(a,b)};
SixthMassLib.prototype.executeFunctions=function(a,b){a&&m6_util.each(a,function(a){var c=a[0];0<a.length&&(a.shift(),c=this[c],"function"===typeof c&&c.apply(b,a))},this)};SixthMassLib.prototype.getUrl=function(){return URL};SixthMassLib.prototype.getProfileUrl=function(){return URL_PROFILE};SixthMassLib.prototype.registerEvent=function(a,b,c){b||console.error("No valid element provided for registerEvent");var d=this;b.addEventListener(a,function(a){d.handleEvents(a,d)},c)};
SixthMassLib.prototype.handleEvents=function(a,b){if(a){this.touchSession();var c=a.target,c="undefined"===typeof a.target?a.srcElement:a.target;c.nodeType===TEXT_NODE&&(c=c.parentNode);for(var d=[c],e=c;e.parentNode&&!m6_util.isTag(e,"body");)d.push(e.parentNode),e=e.parentNode;if(m6_util.shouldTrackDOMEvent(c)){var f=[];m6_util.each(d,function(a,c){var d=m6_util.getPropertiesFromElement(a);b.Config.trackOnlyM6?d&&m6_util.each(d.attributes,function(a,c){a.name&&a.name.startsWith(b.Config.attributePrefix)&&
f.push(d)}):"a"===d.tag_name?f.push(d):"input"===d.tag_name?m6_util.each(d.attributes,function(a,b){"type"!==a.name||"submit"!==a.value&&"button"!==a.value||f.push(d)}):"button"===d.tag_name&&(b.debug(d.attributes),f.push(d))});b.decorateEvents(f,b)}}};
SixthMassLib.prototype.decorateEvents=function(a,b){b.initParams.token?0<a.length&&m6_util.each(a,function(a){m6_util.each(a.attributes,function(a){a.name===b.Config.attributePrefix+b.PostfixAction&&(a=b.createEvent(a.value,null,b),b.queueEvent(a))})}):console.error("Missing token!")};
SixthMassLib.prototype.createEvent=function(a,b,c){var d={},e;m6_util.storage.parse(STORAGE_USER_PROFILE,c.Config.storage);var f=m6_util.storage.parse(STORAGE_SESSION,c.Config.storage);e=this.initUser();d.uId=e.userId;d.cId=c.initParams.token;d.e=a;d.sId=f.sId;d.sessDuration=f.sessDuration;d.ts=m6_util.timestamp();d.tzOffset=60*m6_util.timezone();d.libVer=c.Config.LIB_VERSION;a=m6_util.referingFrom.searchEngine(document.referrer);null!=a?(d.refDomain=a,d.searchQuery=m6_util.referingFrom.searchQuery(document.referrer)):
d.refDomain=m6_util.referingFrom.domain(document.referrer);d.browser=m6_util.referingFrom.browser(window.navigator.userAgent,window.navigator.vendor,window.opera);d.browserVersion=m6_util.referingFrom.browserVersion(window.navigator.userAgent,window.navigator.vendor,window.opera);d.os=m6_util.referingFrom.os(window.navigator.userAgent);d.device=m6_util.referingFrom.device(window.navigator.userAgent);d.lang=m6_util.referingFrom.language();d.pageView=document.location.href;m6_util.isUndefined(b)||(d.customValues=
b);return d=this.augmentEventWithCampaign(d)};
SixthMassLib.prototype.augmentEventWithCampaign=function(a){var b=m6_util.cookieStorage.get("_m6_c"),c=m6_util.cookieStorage.get("_m6_cn"),d=m6_util.cookieStorage.get("_m6_src"),e=m6_util.cookieStorage.get("_m6_trm"),f=m6_util.cookieStorage.get("_m6_m");null!==d&&!m6_util.isUndefined(d)&&1<d.length&&(a.utmSource=d);null!==b&&!m6_util.isUndefined(b)&&1<b.length&&(a.utmCampaign=b,a.campaignType="click");null!==f&&!m6_util.isUndefined(f)&&1<f.length&&(a.utmMedium=f);null!==c&&!m6_util.isUndefined(c)&&
1<c.length&&(a.utmContent=c);null!==e&&!m6_util.isUndefined(e)&&1<e.length&&(a.utmTerm=e);return a};
SixthMassLib.prototype.createProfile=function(a,b,c){var d={},e=m6_util.storage.parse(STORAGE_USER_PROFILE,c.Config.storage);e||(e=c.initUser());d.userId=e.userId;d.clientId=c.initParams.token;d.remoteUserId=a.user_id;d.email=a.email;d.firstName=a.first_name;d.lastName=a.last_name;d.tzOffset=60*m6_util.timezone();d.gender=a.gender;d.businessName=a.business_name;d.birthday=a.birthday;m6_util.isUndefined(b)||(d.customValues=b);m6_util.storage.set(STORAGE_USER_PROFILE,m6_util.JSONEncode(d),c.Config.storage);
return d};SixthMassLib.prototype.createRegister=function(a,b,c){c.createProfile(a,b,this);return c.createEvent("m6 register",null,c)};SixthMassLib.prototype.createPurchase=function(a,b){var c=b.createEvent("m6 purchase",null,b);c.pItems=[];m6_util.each(a,function(a){var b={};b.id=a.id;b.n=a.name;b.pr=a.price;b.q=a.quantity;c.pItems.push(b)});return c};
SixthMassLib.prototype.initUser=function(){var a=m6_util.getQueryParam(window.location.href,"uid");this.storeAllCampaignCookies();var b=m6_util.storage.get(STORAGE_USER_PROFILE,this.Config.storage),c=null==b||m6_util.isUndefined(b);!c&&(b=m6_util.JSONDecode(b),m6_util.isUndefined(b.userId)||null==b.userId||0>=b.userId.length)&&(c=!0);if(c)if(b={},navigator.cookieEnabled){c=m6_util.cookieStorage.get("m6_user_id");if(m6_util.isUndefined(c)||null==c)c=m6_util.isUndefined(a)||null===a?m6_util.uuid4():
a;b.userId=c;m6_util.cookieStorage.set("m6_user_id",c,3650,!0,!1)}else m6_util.isUndefined(a)||null===a?b.userId=m6_util.uuid4():b.userId=a;m6_util.storage.set(STORAGE_USER_PROFILE,m6_util.JSONEncode(b),this.Config.storage);this.touchSession();return b};
SixthMassLib.prototype.touchSession=function(){var a=m6_util.getQueryParam(window.location.href,"s"),b=m6_util.storage.parse(STORAGE_SESSION,this.Config.storage);if(null==b)b={},m6_util.isUndefined(a)||null===a?b.sId=m6_util.uuid4():b.sId=a,b.ts=m6_util.timestamp(),b.lastTouch=m6_util.timestamp(),m6_util.storage.set(STORAGE_SESSION,m6_util.JSONEncode(b),this.Config.storage);else{var c=b.ts,d=b.lastTouch,e=m6_util.timestamp(),f=!0;!m6_util.isUndefined(a)&&null!==a&&1<a.length&&(b.sId=m6_util.uuid4(),
b.ts=e,b.lastTouch=e,m6_util.storage.remove(STORAGE_QUEUE,this.Config.storage),m6_util.storage.remove(STORAGE_QUEUE_INDEX,this.Config.storage),m6_util.storage.set(STORAGE_SESSION,m6_util.JSONEncode(b),this.Config.storage),f=!1);f&&(e-d>6E4*INACTIVE_SESSION_RESET?(console.log("new session defined"),m6_util.storage.remove(STORAGE_QUEUE,this.Config.storage),m6_util.storage.remove(STORAGE_QUEUE_INDEX,this.Config.storage),b.sId=m6_util.uuid4(),b.ts=e):(a=(e-c)/1E3,console.log("session duration current",
a),b.sessDuration=a),b.lastTouch=e,m6_util.storage.set(STORAGE_SESSION,m6_util.JSONEncode(b),this.Config.storage))}return b};
SixthMassLib.prototype.storeAllCampaignCookies=function(){var a=m6_util.getQueryParam(window.location.href,"utm_campaign"),b=m6_util.getQueryParam(window.location.href,"utm_content"),c=m6_util.getQueryParam(window.location.href,"utm_source"),d=m6_util.getQueryParam(window.location.href,"utm_term"),e=m6_util.getQueryParam(window.location.href,"utm_medium");m6_util.isUndefined(a)||null===a||m6_util.cookieStorage.set("_m6_c",a,3650,!0,!1);m6_util.isUndefined(b)||null===b||m6_util.cookieStorage.set("_m6_cn",
b,3650,!0,!1);m6_util.isUndefined(c)||null===c||m6_util.cookieStorage.set("_m6_src",c,3650,!0,!1);m6_util.isUndefined(d)||null===d||m6_util.cookieStorage.set("_m6_trm",d,3650,!0,!1);m6_util.isUndefined(e)||null===e||m6_util.cookieStorage.set("_m6_m",e,3650,!0,!1)};
SixthMassLib.prototype.queueEvent=function(a){var b=null,c=0;try{b=m6_util.islocalStorageSupported()?m6_util.storage.parse(STORAGE_QUEUE,this.Config.storage):globalDataQueue;null==b&&(b=[]);var d={},c=b.push(d)-1;d.queueIndex=c;d.data=a;m6_util.islocalStorageSupported()&&m6_util.storage.set(STORAGE_QUEUE,m6_util.JSONEncode(b),this.Config.storage);this.sendData(b)}catch(e){console.error("storage queue problem:",e)}};
SixthMassLib.prototype.sendData=function(a){if(a)for(var b=0;b<a.length;b++){var c=a[b];if(0<=b-1){var d=a[b-1];c.data.pTs=d.data.ts;c.data.p=d.data.e}c.queueIndex=b;this.httpRequest(c,this.getUrl(),1,!0)}else console.error("required defined queue and url")};
SixthMassLib.prototype.httpRequest=function(a,b,c,d){try{if(!a.sent||1!==a.sent){console.log("sending ...",a);var e=m6_util.createXMLHTTPObject();e.open("POST",b,!0);e.withCredentials=!0;e.setRequestHeader("Content-type","application/json");var f=this;e.onreadystatechange=function(){if(4===e.readyState)if(200===e.status){if(d){var g=m6_util.storage.parse(STORAGE_QUEUE,f.Config.storage);g&&(a.sent=1,a.sentTime=m6_util.timestamp(),g[a.queueIndex]=a,m6_util.storage.set(STORAGE_QUEUE,m6_util.JSONEncode(g),
f.Config.storage),g=m6_util.storage.parse(STORAGE_QUEUE,f.Config.storage))}}else if(1<=c&&15>=c){var h=1===c?2:2*c;console.log("Bad HTTP Status. Retrying: ",h);setTimeout(function(){f.httpRequest(a,b,h)},1E3*h)}else console.error("Bad HTTP status: "+e.status+", "+e.statusText)};e.send(JSON.stringify(a.data))}}catch(g){console.error(g)}};
